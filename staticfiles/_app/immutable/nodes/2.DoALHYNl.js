import{f as x,a as w,c as Se}from"../chunks/DIZ8QG7K.js";import{i as z}from"../chunks/DVgKwy9N.js";import{o as D,z as Ce,j as Me,g as u,M as Ie,A as Ne,B as Le,C as oe,D as ie,F as ae,p as Y,ad as Be,G as de,k as _e,I as qe,ah as he,i as ne,T as C,ap as ve,aq as re,a1 as ce,ar as De,as as He,at as Re,ag as Pe,au as $e,m as Oe,av as Fe,aw as Ue,ab as Ve,ax as Ge,ay as Ye,az as je,aA as ze,aB as Ke,aC as Xe,b as Je,ak as Qe,aj as pe,aD as We,aE as Ze,s as K,w as b,y as M,x as k,t as F,v as X,P as E,aF as ea,q as le,aG as aa,aH as ra}from"../chunks/D26ayvg8.js";import{c as Q,o as ge}from"../chunks/SlcyPQU1.js";import{a as ta,l as me,s as L,e as U}from"../chunks/CKMV1qZk.js";import{p as W,i as P}from"../chunks/CfZm76BJ.js";function sa(e,a,r,l){for(var s=[],t=a.length,o=0;o<t;o++)Re(a[o].e,s,!0);var f=t>0&&s.length===0&&r!==null;if(f){var d=r.parentNode;Pe(d),d.append(r),l.clear(),H(e,a[0].prev,a[t-1].next)}$e(s,()=>{for(var y=0;y<t;y++){var i=a[y];f||(l.delete(i.k),H(e,i.prev,i.next)),Oe(i.e,!f)}})}function ye(e,a,r,l,s,t=null){var o=e,f={flags:a,items:new Map,first:null};D&&Ce();var d=null,y=!1,i=Ie(()=>{var v=r();return ne(v)?v:v==null?[]:he(v)});Me(()=>{var v=u(i),n=v.length;if(y&&n===0)return;y=n===0;let h=!1;if(D){var _=Ne(o)===Le;_!==(n===0)&&(o=oe(),ie(o),ae(!1),h=!0)}if(D){for(var A=null,g,c=0;c<n;c++){if(Y.nodeType===8&&Y.data===Be){o=Y,h=!0,ae(!1);break}var m=v[c],N=l(m,c);g=be(Y,f,A,null,m,N,c,s,a,r),f.items.set(N,g),A=g}n>0&&ie(oe())}D||la(v,f,o,s,a,l,r),t!==null&&(n===0?d?de(d):d=_e(()=>t(o)):d!==null&&qe(d,()=>{d=null})),h&&ae(!0),u(i)}),D&&(o=Y)}function la(e,a,r,l,s,t,o){var f=e.length,d=a.items,y=a.first,i=y,v,n=null,h=[],_=[],A,g,c,m;for(m=0;m<f;m+=1){if(A=e[m],g=t(A,m),c=d.get(g),c===void 0){var N=i?i.e.nodes_start:r;n=be(N,a,n,n===null?a.first:n.next,A,g,m,l,s,o),d.set(g,n),h=[],_=[],i=n.next;continue}if(na(c,A,m),(c.e.f&re)!==0&&de(c.e),c!==i){if(v!==void 0&&v.has(c)){if(h.length<_.length){var S=_[0],T;n=S.prev;var I=h[0],B=h[h.length-1];for(T=0;T<h.length;T+=1)ue(h[T],S,r);for(T=0;T<_.length;T+=1)v.delete(_[T]);H(a,I.prev,B.next),H(a,n,I),H(a,B,S),i=S,n=B,m-=1,h=[],_=[]}else v.delete(c),ue(c,i,r),H(a,c.prev,c.next),H(a,c,n===null?a.first:n.next),H(a,n,c),n=c;continue}for(h=[],_=[];i!==null&&i.k!==g;)(i.e.f&re)===0&&(v??(v=new Set)).add(i),_.push(i),i=i.next;if(i===null)continue;c=i}h.push(c),n=c,i=c.next}if(i!==null||v!==void 0){for(var R=v===void 0?[]:he(v);i!==null;)(i.e.f&re)===0&&R.push(i),i=i.next;var p=R.length;if(p>0){var q=null;sa(a,R,q,d)}}ce.first=a.first&&a.first.e,ce.last=n&&n.e}function na(e,a,r,l){He(e.v,a),e.i=r}function be(e,a,r,l,s,t,o,f,d,y){var i=(d&Fe)!==0,v=(d&Ue)===0,n=i?v?C(s):ve(s):s,h=(d&De)===0?o:ve(o),_={i:h,v:n,k:t,a:null,e:null,prev:r,next:l};try{return _.e=_e(()=>f(e,n,h,y),D),_.e.prev=r&&r.e,_.e.next=l&&l.e,r===null?a.first=_:(r.next=_,r.e.next=_.e),l!==null&&(l.prev=_,l.e.prev=_.e),_}finally{}}function ue(e,a,r){for(var l=e.next?e.next.e.nodes_start:r,s=a?a.e.nodes_start:r,t=e.e.nodes_start;t!==l;){var o=Ve(t);s.before(t),t=o}}function H(e,a,r){a===null?e.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}const oa=Symbol("is custom element"),ia=Symbol("is html");function va(e){if(D){var a=!1,r=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var l=e.value;V(e,"value",null),e.value=l}if(e.hasAttribute("checked")){var s=e.checked;V(e,"checked",null),e.checked=s}}};e.__on_r=r,Ge(r),ta()}}function V(e,a,r,l){var s=ca(e);D&&(s[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||s[a]!==(s[a]=r)&&(a==="loading"&&(e[Ye]=r),r==null?e.removeAttribute(a):typeof r!="string"&&ua(e).includes(a)?e[a]=r:e.setAttribute(a,r))}function ca(e){return e.__attributes??(e.__attributes={[oa]:e.nodeName.includes("-"),[ia]:e.namespaceURI===je})}var fe=new Map;function ua(e){var a=fe.get(e.nodeName);if(a)return a;fe.set(e.nodeName,a=[]);for(var r,l=e,s=Element.prototype;s!==l;){r=Ke(l);for(var t in r)r[t].set&&a.push(t);l=ze(l)}return a}function fa(e,a,r=a){var l=Xe();me(e,"input",s=>{var t=s?e.defaultValue:e.value;if(t=te(e)?se(t):t,r(t),l&&t!==(t=a())){var o=e.selectionStart,f=e.selectionEnd;e.value=t??"",f!==null&&(e.selectionStart=o,e.selectionEnd=Math.min(f,e.value.length))}}),(D&&e.defaultValue!==e.value||Je(a)==null&&e.value)&&r(te(e)?se(e.value):e.value),Qe(()=>{var s=a();te(e)&&s===se(e.value)||e.type==="date"&&!s&&!e.value||s!==e.value&&(e.value=s??"")})}function te(e){var a=e.type;return a==="number"||a==="range"}function se(e){return e===""?null:+e}function ke(e,a,r){if(e.multiple)return a==null?void 0:ne(a)?ha(e,a):We();for(var l of e.options){var s=j(l);if(Ze(s,a)){l.selected=!0;return}}(!r||a!==void 0)&&(e.selectedIndex=-1)}function da(e,a){pe(()=>{var r=new MutationObserver(()=>{var l=e.__value;ke(e,l)});return r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function _a(e,a,r=a){var l=!0;me(e,"change",s=>{var t=s?"[selected]":":checked",o;if(e.multiple)o=[].map.call(e.querySelectorAll(t),j);else{var f=e.querySelector(t)??e.querySelector("option:not([disabled])");o=f&&j(f)}r(o)}),pe(()=>{var s=a();if(ke(e,s,l),l&&s===void 0){var t=e.querySelector(":checked");t!==null&&(s=j(t),r(s))}e.__value=s,l=!1}),da(e)}function ha(e,a){for(var r of e.options)r.selected=a.includes(j(r))}function j(e){return"__value"in e?e.__value:e.value}function pa(e){return function(...a){var r=a[0];return r.stopPropagation(),e==null?void 0:e.apply(this,a)}}function ga(e,a){var t;var r=(t=e.$$events)==null?void 0:t[a.type],l=ne(r)?r.slice():r==null?[]:[r];for(var s of l)s.call(this,a)}var ma=x('<div class="book-card svelte-1lhg1gn"><img class="svelte-1lhg1gn"/> <h3 class="svelte-1lhg1gn"> </h3> <p class="svelte-1lhg1gn"> </p> <p class="svelte-1lhg1gn"> </p></div>');function ya(e,a){K(a,!1);let r=W(a,"book",8);const l=Q();function s(){l("select",r())}z();var t=ma(),o=b(t),f=M(o,2),d=b(f,!0);k(f);var y=M(f,2),i=b(y);k(y);var v=M(y,2),n=b(v);k(v),k(t),F(()=>{V(o,"src",r().cover_image),V(o,"alt",r().title),L(d,r().title),L(i,`by ${r().author.name??""}`),L(n,`$${r().price??""}`)}),U("click",t,s),w(e,t),X()}var ba=x('<div class="search-bar svelte-tyrcj"><input type="text" placeholder="Search by title or author..." class="svelte-tyrcj"/></div>');function ka(e,a){K(a,!1);const r=Q();let l=W(a,"searchTerm",12,"");function s(f){l(f.target.value),r("search",l())}z();var t=ba(),o=b(t);va(o),k(t),fa(o,l),U("input",o,s),w(e,t),X()}var Ea=x("<p>Loading categories...</p>"),Ta=x('<p class="error svelte-1bjnpy2"> </p>'),wa=x("<option> </option>"),xa=x('<select class="svelte-1bjnpy2"><option>All Categories</option><!></select>'),Aa=x('<div class="filter-dropdown svelte-1bjnpy2"><!></div>');function Sa(e,a){K(a,!1);const r=Q();let l=W(a,"selectedCategory",12,""),s=C([]),t=C(!0),o=C(null);ge(async()=>{try{const n=await fetch("http://localhost:8000/api/categories/");if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);E(s,await n.json())}catch(n){E(o,n.message)}finally{E(t,!1)}});function f(n){l(n.target.value),r("filter",l())}z();var d=Aa(),y=b(d);{var i=n=>{var h=Ea();w(n,h)},v=(n,h)=>{{var _=g=>{var c=Ta(),m=b(c);k(c),F(()=>L(m,`Error loading categories: ${u(o)??""}`)),w(g,c)},A=g=>{var c=xa();F(()=>{l(),ea(()=>{u(s)})});var m=b(c);m.value=m.__value="";var N=M(m);ye(N,1,()=>u(s),S=>S.id,(S,T)=>{var I=wa(),B={},R=b(I,!0);k(I),F(()=>{B!==(B=u(T).name)&&(I.value=(I.__value=u(T).name)??""),L(R,u(T).name)}),w(S,I)}),k(c),_a(c,l),U("change",c,f),w(g,c)};P(n,g=>{u(o)?g(_):g(A,!1)},h)}};P(y,n=>{u(t)?n(i):n(v,!1)})}k(d),w(e,d),X()}var Ca=x('<img class="modal-image svelte-1tg8ehu"/> <h2 class="svelte-1tg8ehu"> </h2> <h3 class="svelte-1tg8ehu"> </h3> <p class="price svelte-1tg8ehu"> </p> <p class="svelte-1tg8ehu"> </p> <p class="svelte-1tg8ehu"> </p>',1),Ma=x('<p class="svelte-1tg8ehu">Loading book details...</p>'),Ia=x('<div class="modal-overlay svelte-1tg8ehu"><div class="modal-content svelte-1tg8ehu"><button class="close-button svelte-1tg8ehu">&times;</button> <!></div></div>');function Na(e,a){K(a,!1);let r=W(a,"book",8);const l=Q();function s(){l("close")}z();var t=Ia(),o=b(t),f=b(o),d=M(f,2);{var y=v=>{var n=Ca(),h=le(n),_=M(h,2),A=b(_,!0);k(_);var g=M(_,2),c=b(g);k(g);var m=M(g,2),N=b(m);k(m);var S=M(m,2),T=b(S,!0);k(S);var I=M(S,2),B=b(I);k(I),F(()=>{V(h,"src",r().cover_image),V(h,"alt",r().title),L(A,r().title),L(c,`by ${r().author.name??""}`),L(N,`$${r().price??""}`),L(T,r().description),L(B,`Category: ${r().category.name??""}`)}),w(v,n)},i=v=>{var n=Ma();w(v,n)};P(d,v=>{r()?v(y):v(i,!1)})}k(o),k(t),U("click",f,s),U("click",o,pa(function(v){ga.call(this,a,v)})),U("click",t,s),w(e,t),X()}var La=x("<p>Loading books...</p>"),Ba=x('<p class="error svelte-163m2le"> </p>'),qa=x("<p>No books found matching your criteria.</p>"),Da=x('<div class="controls svelte-163m2le"><!> <!></div> <div class="book-catalog svelte-163m2le"><!></div> <!>',1);function Ha(e,a){K(a,!1);let r=C([]),l=C(!0),s=C(null),t=C(""),o=C(""),f=C(""),d=C(""),y=C(!1),i=C(null),v=C(!1);async function n(){if(!u(v)){E(v,!0),E(l,!0),E(s,null);try{let p=new URL("http://localhost:8000/api/books/");u(t)&&p.searchParams.append("search",u(t)),u(f)&&p.searchParams.append("category__name",u(f));const q=await fetch(p.toString());if(!q.ok)throw new Error(`HTTP error! status: ${q.status}`);E(r,await q.json())}catch(p){p instanceof Error?E(s,p.message):E(s,"An unknown error occurred")}finally{E(l,!1),E(v,!1)}}}function h(p){E(i,p.detail),E(y,!0)}function _(){E(y,!1),E(i,null)}ge(n),aa(()=>(u(t),u(o),u(f),u(d),u(l),u(v)),()=>{(u(t)!==u(o)||u(f)!==u(d))&&!u(l)&&!u(v)&&(E(o,u(t)),E(d,u(f)),n())}),ra(),z();var A=Da(),g=le(A),c=b(g);ka(c,{$$events:{search:p=>{E(t,p.detail)}}});var m=M(c,2);Sa(m,{$$events:{filter:p=>{E(f,p.detail)}}}),k(g);var N=M(g,2),S=b(N);{var T=p=>{var q=La();w(p,q)},I=(p,q)=>{{var Ee=$=>{var G=Ba(),Z=b(G);k(G),F(()=>L(Z,`Error: ${u(s)??""}`)),w($,G)},Te=($,G)=>{{var Z=O=>{var J=qa();w(O,J)},we=O=>{var J=Se(),xe=le(J);ye(xe,1,()=>u(r),ee=>ee.id,(ee,Ae)=>{ya(ee,{get book(){return u(Ae)},$$events:{select:h}})}),w(O,J)};P($,O=>{u(r).length===0?O(Z):O(we,!1)},G)}};P(p,$=>{u(s)?$(Ee):$(Te,!1)},q)}};P(S,p=>{u(l)?p(T):p(I,!1)})}k(N);var B=M(N,2);{var R=p=>{Na(p,{get book(){return u(i)},$$events:{close:_}})};P(B,p=>{u(y)&&p(R)})}w(e,A),X()}var Ra=x('<main class="svelte-1107n2q"><h1 class="svelte-1107n2q">Interactive Book Catalog</h1> <!></main>');function Pa(e){var a=Ra(),r=M(b(a),2);Ha(r,{}),k(a),w(e,a)}function Ya(e){Pa(e)}export{Ya as component};
